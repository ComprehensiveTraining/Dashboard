# 软件设计文档（SD）

- 架构设计
- 技术选型及理由
- 模块划分
- 软件设计思路

---

## 技术选型及理由

我们的项目后端基于Bmob云储存平台，客户端使用Andorid Studio进行原生开发，设计模式为MVC框架，开发语言为Java。

由于项目设计着重于Object-Oriented Programming，因此我们将"产品的交互设计"与"用户体验"视为开发重点。在进行客户端Android开发时，我们严格遵循谷歌近年推出的Material Design规范，以使用Android Design Support Library提供的控件为主，同时根据实际体验进行不断的优化和更新。

在此记录部分所用到的技术以及使用理由。

- `Bmob后端云`

  - 一个很优秀的云储存平台，为移动应用提供了一个完整的后端解决方案，包括轻量级的SDK开发包和各类封装友好的API。它支持10w+读并发，5w+写并发，免费版的各项服务指标能够满足个人开发者或小型团队。
  - [官网](http://doc.bmob.cn/data/android/index.html)附有详细的教程。如果你想看更加具体的API文档，可点此[链接](http://docs.bmob.cn/data/Android/i_doc/doc/index.html)。
  - 不过在使用过程中也遇到了几个小麻烦，比如Bmob不支持多表查询、免费版不支持模糊查询、不可对非当前用户所在数据表进行更改操作。另外，由于Bmob的所有查询操作都属于异步执行，所以要通过启动多线程的方式去完善这个流程。

- `Material Design`

  - ConstranintLayout : 使用最新的约束布局来指定各个控件的位置和关系
  - TabLayout + ViewPager : 实现Tab底部导航、主页面滑动切换
  - FrameLayout + ViewPager : 实现轮播图自动播放、滑动切换
  - CardView + RecyclerView ： 实现卡片式视图、瀑布流效果
  - FloatingActionButton : 悬浮按钮
  - SwipeRefreshLayout : 实现下拉刷新的功能
  - so on

- `ImageLoader框架`

  - 使用多线程，实现网络图片异步加载，避免ListView/RecyclerView在滑动时出现卡顿现象
  - 可灵活配置ImageLoader的基本参数，包括线程数、缓存方式、图片显示选项等
  - 提供高效的缓存机制，包括内存缓存及SDCard缓存
  - 该开源框架的项目地址: [Android-Universal-Image-Loader](https://github.com/nostra13/Android-Universal-Image-Loader)
  
- `Picasso框架`

  - 与ImageLoader基本功能相似，都是主流的图片加载框架
  - 比起ImageLoader，Picasso框架使用了复杂的图片压缩转换来尽可能地减少内存消耗，在实现"图片裁剪后压缩保存至本地"这一功能上能更好发挥作用
  - 该开源框架的项目地址: [square/picasso](https://github.com/square/picasso)
  
- `CircleImageView框架`

  - 一个继承于ImageView的自定义圆形图片控件，主要用于实现用户的圆形头像
  - 该开源框架的项目地址: [hdodenhof/CircleImageView](https://github.com/hdodenhof/CircleImageView)
  
- `编写的自定义工具类`

  - [VpSwipeRefreshLayout.java](https://github.com/15331016/Bmob_Community_Application/blob/master/code/Saying/app/src/main/java/com/example/yc/saying/utils/VpSwipeRefreshLayout.java) : 由于ViewPager轮播图在用手指进行左右滑动时，可能触发SwipeRefreshLayout的下拉刷新机制，从而产生不好的用户体验。为解决该滑动冲突，于是在继承SwipeRefreshLayout的基础上进行函数重写，滑动过程中根据手指在屏幕上的X轴和Y轴位移比较，从而判断事件该交给哪个控件进行处理。比如，当判断X轴位移较大，可能在进行左右滑动，于是引发ViewPager轮播图的滑动事件，当判断Y轴往下的位移较大，此时才会引发SwipeRefreshLayout的下拉刷新机制。
  - [PicturePreviewActivity.java](https://github.com/15331016/Bmob_Community_Application/blob/master/code/Saying/app/src/main/java/com/example/yc/saying/utils/PicturePreviewActivity.java) : 实现大图预览、下载功能。点击图片进入该预览界面，先是判断该图片是否存在本地，若存在便直接读取，否则从网络进行加载。点击右上角的下载图标即可将文件输入流转为bitmap格式，保存到对应的本地路径，同时发送广播通知手机相册。
  - [ZoomImageView.java](https://github.com/15331016/Bmob_Community_Application/blob/master/code/Saying/app/src/main/java/com/example/yc/saying/utils/ZoomImageView.java) : 这个类主要辅助于大图预览功能，实现图片随着手指推动而进行放大缩小的功能。
  - [ProgressDialogHandle.java](https://github.com/15331016/Bmob_Community_Application/blob/master/code/Saying/app/src/main/java/com/example/yc/saying/utils/ProgressDialogHandle.java) : 在发送请求或者进行图片下载时用以标记的一个进度条对话框。







